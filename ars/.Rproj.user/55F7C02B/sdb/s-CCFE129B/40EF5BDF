{
    "contents" : "# generate_uï¼š generate the parameters and breaking points used in the u(x) function\n# Input:\n#    x: a vector of x in Tk\n#    fun: h(x)\n#\t\t fun_deriv: deravative of h(x) \n#\t\t start: lower bound\n#\t\t end: upper bound\n# Output:\n#\t\t parameters and breaking points used in the u(x) function\n\ngenerate_u <- function(x, fun, fun_deriv, start, end){\n  k <- length(x)\n  z <- (fun(x[-1]) - fun(x[-k]) - x[-1]*fun_deriv(x[-1]) + x[-k]*fun_deriv(x[-k]))/(fun_deriv(x[-k]) - fun_deriv(x[-1]))\n  \n  #Construct upper and lower bound\n  z <- c(start, z, end)\n  \n  #Compute slope and intercept\n  a <- fun_deriv(x)\n  b <- fun(x) - a*x\n  \n  out <- list(parameter=cbind(a, b), breaks=z)\n  out\n}\n\n##########Normal Distribution##########\n#Setup\nstart <- -Inf; end <- Inf\nfun <- function(x) dnorm(x, log=TRUE)\nh <- 1e-8\nfun_deriv <- function(x) (fun(x + h) - fun(x - h))/(2*h)\n\n#Initial value\nTk <- c(-1, 1)\nu <- generate_u(Tk, fun, fun_deriv, start, end)\n\n#Make plot\nx <- seq(-5, 5, by=0.1)\nplot(x, fun(x), type=\"l\",\n     main=\"Upper bound for N(0, 1)\",\n     xlab=\"x\", ylab=\"Normal Density in log scale\")\n\nabline(a=u$parameter[1, 2], b=u$parameter[1, 1], col=\"blue\", lty=2)\nabline(a=u$parameter[2, 2], b=u$parameter[2, 1], col=\"blue\", lty=2)\n\n#Error\nTk <- seq(-0.00001, 0.00001, by=1e-8)\nu <- generate_u(Tk, fun, fun_deriv, start, end)\n##########Gamma(3, 3) Distribution##########\n#Setup\nstart <- 0; end <- Inf\nfun <- function(x) dgamma(x, shape=3, rate=3, log=TRUE)\nh <- 1e-8\nfun_deriv <- function(x) (fun(x + h) - fun(x - h))/(2*h)\n\n#Initial value\nTk <- c(0.3, 1.5)\nu <- generate_u(Tk, fun, fun_deriv, start, end)\n\n#Make plot\nx <- seq(0, 3, by=0.01)\nplot(x, fun(x), type=\"l\",\n     main=\"Upper bound for Gamma(3, 3)\",\n     xlab=\"x\", ylab=\"Gamma Density in log scale\")\n\n#lower bound\nabline(v=start, col=\"red\")\n\nabline(a=u$parameter[1, 2], b=u$parameter[1, 1], col=\"blue\", lty=2)\nabline(a=u$parameter[2, 2], b=u$parameter[2, 1], col=\"blue\", lty=2)\n\n##########Exponential Distribution##########\n#Setup\nstart <- 0; end <- Inf\nfun <- function(x) dexp(x, log=TRUE)\nh <- 1e-8\nfun_deriv <- function(x) (fun(x + h) - fun(x - h))/(2*h)\n\n#Initial value\nTk <- c(1, 2)\nu <- generate_u(Tk, fun, fun_deriv, start, end)\n\n#Make plot\nx <- seq(0, 3, by=0.01)\nplot(x, fun(x), type=\"l\",\n     main=\"Upper bound for Exp(1)\",\n     xlab=\"x\", ylab=\"Exponential Density in log scale\")\n\n#lower bound\nabline(v=start, col=\"red\")\n\nabline(a=u$parameter[1, 2], b=u$parameter[1, 1], col=\"blue\", lty=2)\nabline(a=u$parameter[2, 2], b=u$parameter[2, 1], col=\"blue\", lty=2)\n",
    "created" : 1449789320961.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3301224598",
    "id" : "40EF5BDF",
    "lastKnownWriteTime" : 1449782107,
    "path" : "C:/Users/jason/Desktop/STAT 243/Homework/test_generate_u.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}